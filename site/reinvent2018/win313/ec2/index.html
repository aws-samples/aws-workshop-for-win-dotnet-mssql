



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="A collection of Windows on AWS workshops">
      
      
        <link rel="canonical" href="https://awsentworkshops.com/reinvent2018/win313/ec2/">
      
      
        <meta name="author" content="aws-ent-workshops@amazon.com">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../assets/images/aws-favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.1">
    
    
      
        <title>Amazon EC2 - Windows on AWS Workshops</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.3020aac5.css">
      
      
    
    
      <script src="../../../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../stylesheets/custom.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#deploy-an-app-to-ec2-using-azure-devops-vsts" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <!--
  Copyright (c) 2016-2018 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Application header -->
<header class="md-header" data-md-component="header">

    <!-- Top-level navigation -->
    <nav class="md-header-nav md-grid">
      <div class="md-flex">
  
        <!-- Link to home -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <a href="https://aws.amazon.com/"
              title="Amazon Web Services"
              class="md-header-nav__button md-logo">
            
              <img src="../../../assets/images/aws_smile_logo.png" width="40" height="24" />
            
          </a>
        </div>
  
        <!-- Button to toggle drawer -->
        <div class="md-flex__cell md-flex__cell--shrink">
          <label class="md-icon md-icon--menu md-header-nav__button"
              for="__drawer"></label>
        </div>
  
        <!-- Header title -->
        <div class="md-flex__cell md-flex__cell--stretch">
          <div class="md-flex__ellipsis md-header-nav__title"
              data-md-component="title">
            
              
                <span class="md-header-nav__topic">
                  Windows on AWS Workshops
                </span>
                <span class="md-header-nav__topic">
                  Amazon EC2
                </span>
              
            
          </div>
        </div>
  
        <!-- Button to open search dialogue -->
        <div class="md-flex__cell md-flex__cell--shrink">
          
            
              <label class="md-icon md-icon--search md-header-nav__button"
                  for="__search"></label>
  
              <!-- Search interface -->
              
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
            
          
        </div>
        
        <!-- Repository containing source -->
        
        <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-header-nav__lang">
                <div class="md-lang-drop">
                    <button onmouseover="langToggle()" class="md-lang-dropbtn fa fa-globe"></button>
                </div>
            </div>
        </div>

        <!-- Repository containing source -->
        
          <div class="md-flex__cell md-flex__cell--shrink">
            <div class="md-header-nav__source">
              


  

<a href="https://github.com/aws-samples/aws-workshop-for-win-dotnet-mssql/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    aws-samples/aws-workshop-for-win-dotnet-mssql
  </div>
</a>
            </div>
          </div>
        
      </div>
    </nav>
  </header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../index2018/" title="re:Invent 2018" class="md-tabs__link md-tabs__link--active">
          re:Invent 2018
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../reinvent2019/index2019/" title="re:Invent 2019" class="md-tabs__link">
          re:Invent 2019
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../builder-sessions/" title="Builder Sessions" class="md-tabs__link">
          Builder Sessions
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../workshops/" title="Full Day Workshops" class="md-tabs__link">
          Full Day Workshops
        </a>
      
    </li>
  

      
        
      
        
      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://awsentworkshops.com" title="Windows on AWS Workshops" class="md-nav__button md-logo">
      
        <img src="../../../assets/images/aws_smile_logo.png" width="48" height="48">
      
    </a>
    Windows on AWS Workshops
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/aws-samples/aws-workshop-for-win-dotnet-mssql/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    aws-samples/aws-workshop-for-win-dotnet-mssql
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      re:Invent 2018
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        re:Invent 2018
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../index2018/" title="Directory" class="md-nav__link">
      Directory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Win319
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Win319
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../win319/win319index/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win319/prereq/" title="Pre-Requisite" class="md-nav__link">
      Pre-Requisite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win319/1_DeployAd/" title="Create Directory" class="md-nav__link">
      Create Directory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win319/2_DeployMad/" title="Deploy Managed AD" class="md-nav__link">
      Deploy Managed AD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win319/3_Trust/" title="Create Domain Trust" class="md-nav__link">
      Create Domain Trust
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win319/4_Createorg/" title="Create AWS Organization" class="md-nav__link">
      Create AWS Organization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win319/5_ConnectADtoSSO/" title="Connect AD to SSO" class="md-nav__link">
      Connect AD to SSO
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win319/6_VerifyADSSO_MAD/" title="Verify SSO" class="md-nav__link">
      Verify SSO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3" checked>
    
    <label class="md-nav__link" for="nav-3-3">
      Win313
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        Win313
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../win313index/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../setup/" title="Lab Setup" class="md-nav__link">
      Lab Setup
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3-3" type="checkbox" id="nav-3-3-3" checked>
    
    <label class="md-nav__link" for="nav-3-3-3">
      Challenges
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-3">
        Challenges
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Amazon EC2
      </label>
    
    <a href="./" title="Amazon EC2" class="md-nav__link md-nav__link--active">
      Amazon EC2
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture" title="Architecture" class="md-nav__link">
    Architecture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modules" title="Modules" class="md-nav__link">
    Modules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-code-into-azure-devops" title="Import code into Azure DevOps" class="md-nav__link">
    Import code into Azure DevOps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-codedeploy-iam-role" title="Create CodeDeploy IAM Role" class="md-nav__link">
    Create CodeDeploy IAM Role
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-aws-codedeploy" title="Setup AWS CodeDeploy" class="md-nav__link">
    Setup AWS CodeDeploy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-s3-bucket" title="Create S3 bucket" class="md-nav__link">
    Create S3 bucket
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrate-azure-devops-and-aws-codedeploy" title="Integrate Azure DevOps and AWS CodeDeploy" class="md-nav__link">
    Integrate Azure DevOps and AWS CodeDeploy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-the-deployment" title="Test the deployment" class="md-nav__link">
    Test the deployment
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../lambda/" title="AWS Lambda" class="md-nav__link">
      AWS Lambda
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fargate/" title="Amazon ECS Fargate" class="md-nav__link">
      Amazon ECS Fargate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../resources/" title="Resources" class="md-nav__link">
      Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Win308
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        Win308
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../win308/win308index/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win308/prereq/" title="Pre-requisites" class="md-nav__link">
      Pre-requisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4-3" type="checkbox" id="nav-3-4-3">
    
    <label class="md-nav__link" for="nav-3-4-3">
      Challenges
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-3">
        Challenges
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../win308/challenge1/" title="Challenge 1 Configuring resources using AWS Tools for Windows PowerShell" class="md-nav__link">
      Challenge 1 Configuring resources using AWS Tools for Windows PowerShell
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win308/challenge2/" title="Challenge 2 Configure EC2 instances using Powershell and SSM" class="md-nav__link">
      Challenge 2 Configure EC2 instances using Powershell and SSM
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      Win309
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        Win309
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../win309/win309index/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win309/prereq/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win309/resources/" title="Lab Guide" class="md-nav__link">
      Lab Guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Win314
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        Win314
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../win314/win314index/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win314/build/" title="Let's Build" class="md-nav__link">
      Let's Build
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">
    
    <label class="md-nav__link" for="nav-3-7">
      Win310
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        Win310
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../win310/win310index/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win310/scenario/" title="Scenario" class="md-nav__link">
      Scenario
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win310/rehost/" title="Rehost" class="md-nav__link">
      Rehost
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win310/replatform/" title="Replatform" class="md-nav__link">
      Replatform
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win310/refactor/" title="Refactor" class="md-nav__link">
      Refactor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../win310/bonus/" title="Bonus" class="md-nav__link">
      Bonus
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">
    
    <label class="md-nav__link" for="nav-3-8">
      Dev334
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-8">
        Dev334
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev334/dev334index/" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev334/prereq/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev334/resources/" title="Resources" class="md-nav__link">
      Resources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-8-4" type="checkbox" id="nav-3-8-4">
    
    <label class="md-nav__link" for="nav-3-8-4">
      Challenges
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-8-4">
        Challenges
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev334/challenge1/" title="Powershell exercise" class="md-nav__link">
      Powershell exercise
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      re:Invent 2019
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        re:Invent 2019
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../reinvent2019/index2019/" title="Directory" class="md-nav__link">
      Directory
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Builder Sessions
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Builder Sessions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../builder-sessions/" title="Directory" class="md-nav__link">
      Directory
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Full Day Workshops
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Full Day Workshops
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../workshops/" title="Directory" class="md-nav__link">
      Directory
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../contribute/" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prerequisites" title="Prerequisites" class="md-nav__link">
    Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#architecture" title="Architecture" class="md-nav__link">
    Architecture
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modules" title="Modules" class="md-nav__link">
    Modules
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-code-into-azure-devops" title="Import code into Azure DevOps" class="md-nav__link">
    Import code into Azure DevOps
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-codedeploy-iam-role" title="Create CodeDeploy IAM Role" class="md-nav__link">
    Create CodeDeploy IAM Role
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#setup-aws-codedeploy" title="Setup AWS CodeDeploy" class="md-nav__link">
    Setup AWS CodeDeploy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-s3-bucket" title="Create S3 bucket" class="md-nav__link">
    Create S3 bucket
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integrate-azure-devops-and-aws-codedeploy" title="Integrate Azure DevOps and AWS CodeDeploy" class="md-nav__link">
    Integrate Azure DevOps and AWS CodeDeploy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#test-the-deployment" title="Test the deployment" class="md-nav__link">
    Test the deployment
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/aws-samples/aws-workshop-for-win-dotnet-mssql/edit/master/docs/reinvent2018/win313/ec2.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="deploy-an-app-to-ec2-using-azure-devops-vsts">Deploy an app to EC2 using Azure DevOps (VSTS)</h1>
<h2 id="introduction">Introduction</h2>
<p>This article will demonstrate a .Net application deployment to AWS Ec2 using AWS CodeDeploy, GitHub, and Azure DevOps.</p>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>Complete the <a href="../setup/">Lab Setup</a></li>
</ul>
<h3 id="architecture">Architecture</h3>
<p><img alt="a relative link" src="../images/ec2/01_architectureOverview.png" title="Architecture Overview" /></p>
<h3 id="modules">Modules</h3>
<ol>
<li>Import Code into Azure DevOps</li>
<li>Setup AWS CodeDeploy</li>
<li>Integrate Azure DevOps and AWS CodeDeploy</li>
<li>Test the Deployment</li>
</ol>
<h2 id="import-code-into-azure-devops">Import code into Azure DevOps</h2>
<p>In this module we will pull a .NET application from GitHub to be used in our deployment.</p>
<ol>
<li>Go to https://dev.azure.com/ and login to your Azure DevOps account.</li>
<li>Click New Project</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/02_newProject.png" title="Azure DevOps New Project" /></p>
<ol start="3">
    <li>Fill in the name, description and take the default setting for the other options.
   <ol type="a">
    <li>Visibility: Private</li>
    <li>Version Control: Git</li>
    <li>Work item Process: Agile</li>
   </ol>
   </li>
</ol>

<p><img alt="a relative link" src="../images/ec2/03_createProject.png" title="Azure DevOps New Project" /></p>
<ol start="4">
    <li>Click Create.</li>
    <li>Next, we will import the code. Select the Repos tab on the left and then click the import button under “or Import a repository.”</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/07_cloneCode.png" title="Search for CodeDeploy" /></p>
<ol start="6">
    <li>Put https://github.com/StevenDavid/ASPDotNetMVC in the Clone URL input box. Click Import.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/08_importGit.png" title="Search for CodeDeploy" /></p>
<ol start="7">
    <li>Once import is complete, you will see a confirmation screen and then be refreshed to the code view. Your code is now in Azure DevOps.</li>
</ol>

<h2 id="create-codedeploy-iam-role">Create CodeDeploy IAM Role</h2>
<p>In this step we will create the role to be used by CodeDeploy.</p>
<ol start="1">
    <li>From the AWS Console search for IAM.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/99_IAMsearch.png" title="Search for IAM" /></p>
<ol start="2">
    <li>Click on "Roles" in the left hand menu.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/99b_selectRole.png" title="Search for IAM" /></p>
<p><ol start="3">
    <li>Click on the "Create role" button.</li>
</ol></p>
<p><img alt="a relative link" src="../images/ec2/99c_createRole.png" title="click create role" /></p>
<p><ol start="4">
    <li>Make sure "AWS Service" is selected and click on CodeDeploy in the "Choose the service that will use this role" section.</li>
</ol></p>
<p><img alt="a relative link" src="../images/ec2/99d_roleService.png" title="Select CodeDeploy service for role" /></p>
<p><ol start="5">
    <li>Scroll down and in the "Select your use case" section, select the top "CodeDeploy" option. Click "Next:Permissions"</li>
</ol></p>
<p><img alt="a relative link" src="../images/ec2/99e_roleUseCase.png" title="Select CodeDeploy use case" /></p>
<p><ol start="6">
    <li>Wait for the "AWSCodeDeployRole" permissions to load then click "Next:Tags"</li>
</ol></p>
<p><img alt="a relative link" src="../images/ec2/99f_rolePermissions.png" title="Select CodeDeploy use case" /></p>
<ol start="7">
    <li>Add whatever tags you want and then click "Next:Review"</li>
</ol>

<ol start="8">
    <li>Name the Role something like "CodeDeployRole" and then click "Create role"</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/99g_reviewRole.png" title="Select CodeDeploy use case" /></p>
<h2 id="setup-aws-codedeploy">Setup AWS CodeDeploy</h2>
<p>In this step we will create an application in CodeDeploy and a deployment group.</p>
<ol start="1">
    <li>From the AWS Console search for CodeDeploy.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/04_searchCodeDeploy.png" title="Search for CodeDeploy" /></p>
<p>Note: It will take you to the new version of the interface. Click the "Return to the old experience" in the bottom left hand side of the screen.</p>
<p><img alt="a relative link" src="../images/ec2/04b_codeDeployGetStarted.png" title="New Interface" /></p>
<ol start="2">
    <li>Click the Get Started Now button
    <ul><li>Note: if you are on the new version of the CodeDeploy interface. Use the link, in the blue bar, at the top of the page to revert to the old version and select the <b>"Sample Deployment Wizard"</b> from the right hand side of the page.</li></ul></li>
</ol>

<p><img alt="a relative link" src="../images/ec2/05_codeDeployGetStarted.png" title="CodeDeploy Get Started" /></p>
<ol start="3">
    <li>Chose the Sample Deployment and click Next.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/06_sampleDeployment.png" title="Sample Deployment" /></p>
<ol start="4">
    <li>Choose In-place deployment and click Next.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/09_inPlace.png" title="In place Deployment" /></p>
<ol start="5">
    <li>Change the instance type to Windows, select or create a key pair and click Launch instances.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/10_configInstance.png" title="Configure Instance" /></p>
<ol start="6">
    <li>Name your CodeDeploy Application. Click Next.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/11_nameApp.png" title="Name Application" /></p>
<ol start="7">
    <li>Select the sample application for Windows. This will deploy a generic sample application to your servers. We will overwrite it with the code we checked into Azure DevOps. Click Next.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/12_selectApp.png" title="Select Application" /></p>
<ol start="8">
    <li>Create a Deployment Group. Click Next.</li>
</ol>

<p><img alt="a relative link" src="images/ec2/12b_createDeploymentGroup.png" title="Select Service Role" /></p>
<ol start="9">
    <li>We will select the role we created earlier. Click Next.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/13_ServiceRole.png" title="Select Service Role" /></p>
<ol start="10">
    <li>For the Deployment Configuration we will use the default. Click Next. </li>
</ol>

<p><img alt="a relative link" src="../images/ec2/14_deployConfig.png" title="Choose a deployment configuration" /></p>
<ol start="11">
    <li>Review the Deployment details and click Deploy. CodeDeploy will do the initial deployment and is ready to receive our application.</li>
</ol>

<h2 id="create-s3-bucket">Create S3 bucket</h2>
<ol start="1">
    <li>From the AWS Console search for S3.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/80a_searchS3.png" title="Search for s3" /></p>
<p><ol start="2">
    <li>Click Create bucket.</li>
</ol></p>
<p><img alt="a relative link" src="../images/ec2/80b_createBucket.png" title="Create bucket" /></p>
<ol start="3">
    <li>Name the bucket some thing unique, chose the region you are using for codedeploy (Canada is our recommendation) and click next until you create the bucket.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/80c_nameBucket.png" title="Create bucket" /></p>
<h2 id="integrate-azure-devops-and-aws-codedeploy">Integrate Azure DevOps and AWS CodeDeploy</h2>
<p>In this step we will create a Azure DevOps build job that will deploy our application to EC2 instances via CodeDeploy.</p>
<ol start="1">
    <li>Open our project in Azure DevOps and click on the Pipelines tab. Click New Pipeline.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/15_noPipes.png" title="Azure DevOps default screen when there are no piplines found" /></p>
<ol start="2">
    <li>Azure Repos Git is our source repo and we want to publish the master branch. Click Continue.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/16_selectSource.png" title="Select a source" /></p>
<ol start="3">
    <li>Choose the ASP.NET template and click Apply.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/17_chooseASPDotNet.png" title="Choose Application type: ASP.NET" /></p>
<ol start="4">
    <li>Click the + symbol to add a new task.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/18_addNewTask.png" title="Add New Task" /></p>
<ol start="5">
    <li>Search for the Copy files task and click Add. The task will go to the bottom of the list on the left.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/19_copyFiles.png" title="Add New Task" /></p>
<ol start="6">
    <li>Click the Copy files task and update the parameters. <ul>
    <li>Source Folder: ASPDotNetMVC</li>
    <li>Target Folder: $(Build.ArtifactStagingDirectory)\\publish</li>
    </ul>
    </li>
</ol>

<p><img alt="a relative link" src="../images/ec2/20_copyParams.png" title="Copy parameters" /></p>
<ol start="7">
    <li>Click the + symbol to add a new task. Search for the CodeDeploy task and click Add. The Task will go to the bottom of the list on the left. Update the parameters.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/21_codeDeployTask.png" title="Add CodeDeploy Task" /></p>
<p>Note: Your first time you will need to install the AWS Azure DevOps toolkit from the Marketplace.</p>
<ol start="8">
    <li>Configure the Code Deploy task.
    <ul><li>Note: Application name has to match the CodeDeploy Application name. Same is true for Deployment Group Name.</li></ul>
    </li>
</ol>

<p><img alt="a relative link" src="../images/ec2/22_configCodeDeployTask1.png" title="Configure CodeDeploy Task1" />
   <img alt="a relative link" src="../images/ec2/23_configCodeDeployTask2.png" title="Configure CodeDeploy Task2" /></p>
<ol start="9">
    <li>Click Triggers and enable Continuous integration.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/24_triggers.png" title="Set Continuous Integration on checkin" /></p>
<ol start="10">
    <li>Save the build.</li>
</ol>

<h2 id="test-the-deployment">Test the deployment</h2>
<p>In this module, we will deploy the code to the EC2 instances.</p>
<ol start="1">
    <li>Make a change to your code and check it into Azure DevOps which initiates a build. Once the build is complete you will be able to click through the various steps in the process.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/25_build.png" title="Build screen" /></p>
<ol start="2">
    <li>You can view your deployed application by getting the public DNS or IP address for the EC2 instance and to navigate to the site in a browser.</li>
</ol>

<p><img alt="a relative link" src="../images/ec2/26_webapp.png" title="Screenshot of the deployed web application" /></p>
<ol start="3">
    <li>You now have a working CI/CD pipeline that deploys an ASP.NET application from source control to EC2.</li>
</ol>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../setup/" title="Lab Setup" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Lab Setup
              </span>
            </div>
          </a>
        
        
          <a href="../lambda/" title="AWS Lambda" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                AWS Lambda
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2019, Amazon Web Services, Inc. or its affiliates. All rights reserved.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../../assets/fonts/font-awesome.css">
    
      <a href="https://awsentworkshops.com" class="md-footer-social__link fa fa-home"></a>
    
      <a href="https://aws.amazon.com/windows/" class="md-footer-social__link fa fa-globe"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.dc02f8ce.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="../../../javascripts/extra.js"></script>
      
    
  </body>
</html>